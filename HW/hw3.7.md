##ДЗ3.7.2

1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows? 
```
ip a, ifconfig
ipconfig \all
```

2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?
```
Link Layer Discovery Protocol (LLDP) в Ubuntu утанавливается пакетом  lldpd, посмотерть соседей:
lldpcli show neighbors
```

3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.
virtual local area network (VLAN). Конфигурация в ubuntu:
```
sudo apt install vlan && modprobe --first-time 8021q
sudo ip link add link enp1s0 name enp1s0.100 type vlan id 100 && sudo ip addr add 10.30.134.2/24 dev enp1s0.100
Настройка через netplan:
network:
  ethernets:
    enp1s0:
      dhcp4: false
      addresses:
        - 192.168.5.201/24
      gateway4: 192.168.5.1
      nameservers:
          addresses: [192.168.5.1, 8.8.8.8]
    vlans:
        enp1s0.100:
            id: 100
            link: enp1s0
            addresses: [10.30.134.2/24]
```

4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.
```
Можно использовать драйвер bonding и teaming
Параметры (опции) модуля bonding:

 mode — определяет политику поведения объединенных интерфейсов. Возможные значения:

 balance-rr       или 0	Политика round-robin. Пакеты отправляются последовательно, начиная с первого доступного интерфейса и заканчивая последним. Эта политика применяется для балансировки нагрузки и отказоустойчивости
 active-backup или 1 	Политика активный-резервный. Только один сетевой интерфейс из объединённых будет активным. Другой интерфейс может стать активным, только в том случае, когда упадёт текущий активный интерфейс. При такой политике MAC адрес bond интерфейса виден снаружи только через один сетевой порт, во избежание появления проблем с коммутатором. Эта политика применяется для отказоустойчивости.
 balance-xor    или 2 	Политика XOR. Передача распределяется между сетевыми картами используя формулу: [( «MAC адрес источника» XOR «MAC адрес назначения») по модулю «число интерфейсов»]. Получается одна и та же сетевая карта передаёт пакеты одним и тем же получателям. Опционально распределение передачи может быть основано и на политике «xmit_hash».  Политика XOR применяется для балансировки нагрузки и отказоустойчивости. 
 broadcast       или 3 	 Широковещательная политика. Передает всё на все сетевые интерфейсы. Эта политика применяется для отказоустойчивости.
 802.3ad           или 4 	Политика агрегирования каналов по стандарту IEEE 802.3ad. Создаются агрегированные группы сетевых карт с одинаковой скоростью и дуплексом. При таком объединении передача задействует все каналы в активной агрегации, согласно стандарту IEEE 802.3ad. Выбор через какой интерфейс отправлять пакет определяется политикой, по умолчанию XOR политика, можно использовать «xmit_hash» политику. 
Требования:
1. Поддержка Ethtool в драйвере, для получения информации о скорости и дуплексе на каждом сетевом интерфейсе
2. Поддержка на коммутаторе стандарта IEEE 802.3ad
3. Настройка на коммутаторе
 balance-tlb     или 5	Политика адаптивной балансировки нагрузки передачи. Исходящий трафик распределяется в зависимости от загруженности каждой сетевой карты (определяется скоростью загрузки). Не требует дополнительной настройки на коммутаторе. Входящий трафик приходит на текущую сетевую карту. Если она выходит из строя, то другая сетевая карта берёт себе MAC адрес вышедшей из строя карты. 
Требования:
1. Поддержка Ethtool в драйвере, для получения информации о скорости загрузки на каждом сетевом интерфейсе.
 balance-alb    или 6	Политика адаптивной балансировки нагрузки. Включает в себя политику balance-tlb плюс осуществляет балансировку входящего трафика. Не требует дополнительной настройки на коммутаторе. Балансировка входящего трафика достигается путём ARP переговоров. Драйвер bonding перехватывает ARP ответы, отправляемые с локальных сетевых карт наружу, и переписывает MAC адрес источника на один из уникальных MAC адресов сетевой карты, участвующей в объединении. Таким образом различные пиры используют различные MAC адреса сервера. Балансировка входящего трафика распределяется последовательно (round-robin) между интерфейсами.
Требования:
1. Поддержка Ethtool в драйвере, для получения информации о скорости загрузки на каждом сетевом интерфейсе.
2. Поддержка в драйвере замены MAC адреса на включенном устройстве.
3. Возможно придётся корректировать значение параметра updelay равным или большим, чем значение задержки на коммутаторе (что бы ARP ответы небыли заблокированы на коммутаторе при переподключении линка, либо при добавлении новой сетевой карты в bonding)
 

ad_select — определяет логику выбора для агрегации по стандарту IEEE 802.3ad (эта опция добавлена в bonding начиная с версии 3.4.0.). Возможные значения:

stable        или 0 	Это значение по умолчанию. Активный агрегатор выбирается по наибольшей объединённой полосе пропускания. Перевыбор активного агрегатора осуществляется, только, когда упадут линки на всех сетевых картах в активном агрегаторе, либо если активный агрегатор не имеет сетевых карт.
bandwidth или 1 	Активный агрегатор выбирается по наибольшей объединённой полосе пропускания. Перевыбор активного агрегатора происходит если:
— сетевой интерфейс добавился или удалился из объединения
— на любом интерфейсе изменилось состояние линка
— любой интерфейс изменил состояние ассоциации 802.3ad
— административно перевели состояние интерфейса bond в поднятое (up)
count        или 2	 Активный агрегатор выбирается по наибольшему числу портов. Перевыбор происходит при таких же условиях, как и для значения bandwidth.
```
5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.
```
8 Адресов можно использовать с /29 маской. Подсеть 10.10.10.0/24 можно разбить на 32 подсети с маской /29, расчет: 256/8 = 32
0-7, 8-15, 16-23, 24-31, 32-39, 40-47, 48-55, 56-63,
64-71, 72-79, 80-87, 88-95, 96-103, 104-111, 112-119, 120-127,
128-135, 136-143, 144-151, 152-159, 160-167, 168-175, 176-183, 184-191,
192-199, 200-207, 208-215, 216-223, 224-231, 232-239, 240-247, 248-255

Примеры сетей:
10.10.10.0/29, 10.10.10.8/29, 10.10.10.16/29 
```
6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.
```
Адрес		100.64.0.0	
Bitmask		26		
Netmask		255.255.255.192
Wildcard	0.0.0.63	
Network		100.64.0.0	
Broadcast	100.64.0.63	
Hostmin		100.64.0.1
Hostmax		100.64.0.62
Hosts		62

Дотсупно 62 хоста.
```

7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?
```
ip neigh flush all [dev <device>]
arp -d <host>                   удаляет запись, соответствующую хосту.
arp -d -a                       удаляет все записи таблицы.
Windows:
netsh interface ip delete arpcache
arp -d <host>                   удаляет запись, соответствующую хосту.
```
