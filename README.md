# Devops-Netology
ДЗ 3.2

## ДЗ 3.2

1. Какого типа команда cd? Попробуйте объяснить, почему она именно такого типа; опишите ход своих мыслей, если считаете что она могла бы быть другого типа.

```

type -t cd

builtin - встроенная в оболочку программа. Она вызывается и выполняется в текущей оболочке. Если команда будет внешняя она не будет менят текущий коталог оболочки.

```

2. Какая альтернатива без pipe команде grep &lt;some\\\_string&gt; &lt;some\\\_file&gt; | wc -l? man grep поможет в ответе на этот вопрос. Ознакомьтесь с документом о других подобных некорректных вариантах использования pipe.

```

grep &lt;some\\\_string&gt; &lt;some\\\_file&gt; -c

-c, --count Suppress normal output; instead print a count of matching lines for each input file.

```

3. Какой процесс с PID 1 является родителем для всех процессов в вашей виртуальной машине Ubuntu 20.04?

```

systemd(1)

Посмотреть дерево процессов:

pstree -p

Посмотреть по PID:

ps -p 1

Статус процесса:

cat /proc/1/status

```

4. Как будет выглядеть команда, которая перенаправит вывод stderr ls на другую сессию терминала?

```

Мы находимся по умолчанию в /dev/pts/0 (команда tty)

cat error-test 2>/dev/pts/1

В /dev/pts/1 будет вывод:

cat: error-test: No such file or directory

```

5. Получится ли одновременно передать команде файл на stdin и вывести ее stdout в другой файл? Приведите работающий пример.

```

cat &lt; file1 &gt; file2

```

6. Получится ли вывести находясь в графическом режиме данные из PTY в какой-либо из эмуляторов TTY? Сможете ли вы наблюдать выводимые данные?

```

Да, через перенаправление, увидеть выводимые данные на своем терминале не сможем, нужно перейти в эмулятор терминала с помощью Ctrl + Alt + F1..F6

```

7. Выполните команду bash 5>&1. К чему она приведет? Что будет, если вы выполните echo netology > /proc/$$/fd/5? Почему так происходит?

```

bash 5>&1 создаёт дескриптор c FD 5 и перенаправит его в stdout

далее команда выведет netology в дескриптор "5", который был перенаправлен в stdout и на терминале будет вывод: netology

```

8. Получится ли в качестве входного потока для pipe использовать только stderr команды, не потеряв при этом отображение stdout на pty? Напоминаем: по умолчанию через pipe передается только stdout команды слева от | на stdin команды справа. Это можно сделать, поменяв стандартные потоки местами через промежуточный новый дескриптор, который вы научились создавать в предыдущем вопросе.

```

cat test 5>&2 2>&1 1>&5 (test не существует.)

```

9. Что выведет команда cat /proc/$$/environ? Как еще можно получить аналогичный по содержанию вывод?

```

Переменные окружения. Аналогично export или env.

```

10. Используя man, опишите что доступно по адресам /proc//cmdline, /proc//exe.

```

/ proc / \\\[pid\\\] / cmdline - это файл только для чтения, который содержит полную информацию о процессе из командной строки. Если процесс был заменен местами в дополнение к памяти или процесс является зомби-процессом, то этот файл не имеет содержимого. Файл заканчивается нулевым символом вместо символа новой строки

/ proc / \\\[pid\\\] / exe - это символическая ссылка на фактически работающую программу.

```

11. Узнайте, какую наиболее старшую версию набора инструкций SSE поддерживает ваш процессор с помощью /proc/cpuinfo.

```

sse4_2

grep sse /proc/cpuinfo

```

12. При открытии нового окна терминала и vagrant ssh создается новая сессия и выделяется pty. Это можно подтвердить командой tty, которая упоминалась в лекции 3.2. Однако:

vagrant@netology1:~$ ssh localhost 'tty' not a tty Почитайте, почему так происходит, и как изменить поведение.

```

SSH не устанавливает TTY по умолчанию, когда в списке аргументов передается явная команда (в отличие от запуска удаленной интерактивной оболочки в качестве операции по умолчанию)

Для изменения такого поведения нужно использовать аргумент -t, подробности:

Quoting the man page for ssh:

-t - Force pseudo-terminal allocation. This can be used to execute arbitrary screen-based programs on a remote machine, which can be very useful, e.g. when implementing menu services. Multiple -t options force tty allocation, even if ssh has no local tty.

Quoting the ssh_config man page:

RequestTTY - Specifies whether to request a pseudo-tty for the session. The argument may be one of: no (never request a TTY), yes (always request a TTY when standard input is a TTY), force (always request a TTY) or auto (request a TTY when opening a login session). This option mirrors the -t and -T flags for ssh(1).

```

13. Бывает, что есть необходимость переместить запущенный процесс из одной сессии в другую. Попробуйте сделать это, воспользовавшись reptyr. Например, так можно перенести в screen процесс, который вы запустили по ошибке в обычной SSH-сессии.

```

Работает только через sudo reptyr -T $PID, при этом многие вещи перехватить не получается:

Unable to attach to pid 21177: Permission denied

```

14. sudo echo string > /root/new\\\_file не даст выполнить перенаправление под обычным пользователем, так как перенаправлением занимается процесс shell'а, который запущен без sudo под вашим пользователем. Для решения данной проблемы можно использовать конструкцию echo string | sudo tee /root/new\\\_file. Узнайте что делает команда tee и почему в отличие от sudo echo команда с sudo tee будет работать.

```

Команда tee считывает стандартный ввод (stdin), после чего записывает его в стандартный вывод (stdout) и одновременно копирует его в подготовленный файл или переменную

Работает т.к. запущена от sudo, команда выполняется с привелегияеми root.

```
